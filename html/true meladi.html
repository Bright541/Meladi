<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="game_15459691">
  <title>Meladi: Make Music for You</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    /* General Body Styling */
    body {
      font-family: 'Poppins', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #0d0d0d, #1c1c1c);
      color: #f5f5f5;
      transition: all 0.3s ease;
    }

    /* Navbar Styling */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: #181818;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo {
      width: 40px;
      height: 40px;
    }

    .nav-center {
      display: flex;
      justify-content: center;
      flex: 1;
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .search-container {
      background: #333;
      border-radius: 20px;
      padding: 5px 15px;
      width: 200px; /* Decreased width */
    }

    .search-container input {
      width: 100%;
      background: none;
      border: none;
      color: white;
      padding: 8px;
      font-size: 14px;
    }

    .search-container input:focus {
      outline: none;
    }

    /* Icon buttons style */
    .icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      background: #333;
      color: #ff9800;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .icon-btn:hover {
      background: #444;
      transform: scale(1.1);
    }

    .icon-btn i {
      font-size: 16px;
    }

    .nav-right {
      display: flex;
      align-items: center;
    }

    /* Auth button styles */
    .auth-buttons {
      display: flex;
      gap: 15px;
    }

    .login-btn, .signin-btn {
      padding: 8px 20px;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
    }

    .login-btn {
      background: transparent;
      color: #ff9800;
      border: 2px solid #ff9800;
    }

    .login-btn:hover {
      background: rgba(255, 152, 0, 0.1);
    }

    .signin-btn {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
    }

    .signin-btn:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    /* Minimal user profile styles */
    .user-profile {
      position: relative;
      cursor: pointer;
    }

    .user-initial {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      overflow: hidden;
    }

    .user-initial img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      position: absolute;
      bottom: 0;
      right: 0;
      background: #34a853;
      border: 2px solid #181818;
    }

    /* Sidebar Styling */
    .sidebar {
      width: 250px;
      height: 100vh;
      background: #121212;
      position: fixed;
      left: 0;
      top: 0;
      padding: 20px 0;
      color: #fff;
      overflow-y: auto;
      transition: width 0.3s ease;
    }

    .logo {
      display: flex;
      align-items: center;
      padding: 0 20px;
      margin-bottom: 30px;
    }

    .logo img {
      width: 40px;
      height: 40px;
      margin-right: 10px;
    }

    .logo h1 {
      font-size: 24px;
      margin: 0;
      color: #fff;
    }

    .nav-item {
      list-style: none;
      margin: 4px 0;
    }

    .nav-item a {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: #b3b3b3;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .nav-item a:hover {
      color: #fff;
      background: rgba(255, 255, 255, 0.1);
    }

    .nav-item.active a {
      color: #fff;
      background: rgba(255, 152, 0, 0.2);
      border-left: 4px solid #ff9800;
    }

    .nav-item i {
      width: 24px;
      margin-right: 12px;
      font-size: 18px;
    }

    .nav-divider {
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 20px 0;
    }

    .nav-header {
      padding: 0 20px;
      margin: 10px 0;
      color: #808080;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* Main Content Styling */
    .main-content {
      margin-left: 250px;
      padding: 20px;
    }

    .main-content h1 {
      font-size: 36px;
      text-align: center;
      margin-bottom: 25px;
    }

    /* Trending Section */
    .trending-container {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }

    .trending-item {
      width: 240px;
      background: #202020;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
      animation: fadeInUp 1s ease-out;
    }

    .trending-item:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
    }

    .trending-item img {
      width: 100%;
      height: 150px;
      border-radius: 12px;
      object-fit: cover;
    }

    .trending-item h3 {
      margin: 15px 0;
      font-size: 20px;
      color: #ff9800;
    }

    .trending-item button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .trending-item button:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    /* Animations */
    @keyframes fadeIn {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Profile Picture */
    #profilePicture {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: #444;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: bold;
      color: #ff9800;
      cursor: pointer;
      position: relative;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    #profilePicture:hover {
      transform: scale(1.1);
      box-shadow: 0 0 12px #ff9800;
    }

    .green-dot {
      width: 12px;
      height: 12px;
      background: green;
      border-radius: 50%;
      position: absolute;
      bottom: 5px;
      right: 5px;
      border: 2px solid #202020;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .navbar {
        flex-direction: column;
        align-items: flex-start;
      }

      .main-content {
        margin-left: 70px;
      }

      .sidebar {
        width: 70px;
      }

      .logo h1,
      .nav-item span,
      .nav-header {
        display: none;
      }

      .nav-item a {
        justify-content: center;
        padding: 12px;
      }

      .nav-item i {
        margin: 0;
        font-size: 20px;
      }

      .top-artists,
      .trending-container {
        font-size: 18px;
      }
    }

    /* Add smooth scrollbar for sidebar */
    .sidebar::-webkit-scrollbar {
      width: 6px;
    }

    .sidebar::-webkit-scrollbar-track {
      background: transparent;
    }

    .sidebar::-webkit-scrollbar-thumb {
      background: #404040;
      border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover {
      background: #505050;
    }

    /* Dialog Styling */
    dialog {
      background: #2c2c2c;
      border-radius: 12px;
      padding: 20px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
      border: none;
      color: #f5f5f5;
    }

    dialog h2 {
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
      color: #ff9800;
    }

    dialog label {
      display: block;
      margin-bottom: 8px;
      font-size: 16px;
      color: #ccc;
    }

    dialog input[type="email"],
    dialog input[type="password"] {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 6px;
      border: 1px solid #444;
      background: #333;
      color: #f5f5f5;
      font-size: 16px;
    }

    dialog input[type="email"]:focus,
    dialog input[type="password"]:focus {
      outline: none;
      border: 1px solid #ff9800;
      background: #444;
    }

    dialog menu {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    dialog menu button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      border: none;
      padding: 12px 20px;
      color: white;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
    }

    dialog menu button:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    dialog menu button[type="button"] {
      background: #444;
      color: #ccc;
      border-radius: 25px;
      font-size: 14px;
    }

    /* Add this to your CSS */
    .search-bar {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .search-bar input {
      width: 60%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-right: 10px;
    }

    .search-bar button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    #searchResults {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }

    dialog menu button[type="button"]:hover {
      background: #555;
      color: #ff9800;
    }

    @media (max-width: 768px) {
      dialog {
        width: 90%;
      }

      dialog h2 {
        font-size: 22px;
      }

      dialog label {
        font-size: 14px;
      }

      dialog input[type="email"],
      dialog input[type="password"] {
        font-size: 14px;
        padding: 10px;
      }

      dialog menu button {
        font-size: 14px;
      }
    }

    .search-bar {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .search-bar input {
      width: 60%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-right: 10px;
    }

    .search-bar button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    #searchResults {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .search-result-item {
      width: 240px;
      background: #202020;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
      text-align: center;
    }

    .search-result-item img {
      width: 100%;
      height: 150px;
      border-radius: 12px;
      object-fit: cover;
    }

    .search-result-item h3 {
      margin: 15px 0;
      font-size: 20px;
      color: #ff9800;
    }

    .search-result-item button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    /* User Profile Styling */
    .dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: linear-gradient(135deg, #202020 0%, #2d2d2d 100%);
      border-radius: 12px;
      padding: 20px;
      margin-top: 12px;
      min-width: 280px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      z-index: 1000;
      border: 1px solid rgba(255, 152, 0, 0.2);
    }

    .user-info {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 16px;
    }

    .profile-picture-container {
      position: relative;
      width: 100px;
      height: 100px;
      margin-bottom: 16px;
    }

    .profile-picture {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #ff9800;
      background: #333;
      transition: all 0.3s ease;
    }

    .profile-picture:hover {
      border-color: #ff5722;
      transform: scale(1.05);
    }

    .profile-upload-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      cursor: pointer;
    }

    .profile-picture-container:hover .profile-upload-overlay {
      opacity: 1;
    }

    .profile-upload-overlay i {
      color: #fff;
      font-size: 24px;
      margin-bottom: 4px;
    }

    .profile-upload-overlay span {
      color: #fff;
      font-size: 12px;
      text-align: center;
    }

    .background-color-picker {
      margin: 12px 0;
      text-align: center;
    }

    .background-color-picker label {
      display: block;
      margin-bottom: 8px;
      color: #b3b3b3;
      font-size: 14px;
    }

    .color-options {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 8px;
    }

    .color-option {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .color-option:hover {
      transform: scale(1.1);
    }

    .color-option.selected {
      border-color: #ff9800;
    }

    .user-info span {
      display: block;
      color: #fff;
      margin: 4px 0;
      font-size: 16px;
      font-weight: 500;
    }

    .user-info .user-email {
      color: #b3b3b3;
      font-size: 14px;
    }

    /* File input styling */
    .file-input {
      display: none;
    }

    .dropdown-item {
      width: 100%;
      padding: 8px;
      border: none;
      background: none;
      color: #ff9800;
      cursor: pointer;
      text-align: left;
      font-size: 14px;
    }

    .dropdown-item:hover {
      background: #333;
    }

    .button-container {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }

    .action-button {
      display: flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .action-button:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    .button-icon {
      width: 16px;
      height: 16px;
      object-fit: contain;
    }

    .trending-item, .search-result-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .trending-item h3, .search-result-item h3 {
      margin: 15px 0 5px 0;
      text-align: center;
    }

    .trending-item p, .search-result-item p {
      margin: 0 0 10px 0;
      text-align: center;
    }

    .customize-profile-btn {
      display: block;
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 20px;
      margin: 10px 0;
      text-align: center;
      transition: all 0.3s ease;
    }

    .customize-profile-btn:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    /* Add this CSS for the updated search bar */
    .search-container {
      padding: 20px;
      margin-bottom: 20px;
    }

    .search-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      max-width: 800px;
      margin: 0 auto;
    }

    .search-bar input {
      flex: 1;
      padding: 12px 20px;
      border-radius: 25px;
      border: 2px solid #ff9800;
      background: #202020;
      color: #f5f5f5;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .search-bar input:focus {
      outline: none;
      border-color: #ff5722;
      box-shadow: 0 0 10px rgba(255, 152, 0, 0.3);
    }

    .search-bar button {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .search-bar button:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
      transform: scale(1.05);
    }

    .search-bar button i {
      font-size: 18px;
    }

    /* Add Font Awesome CDN in the head section */
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css');

    /* Friends Bar Styling */
    .friends-bar {
      background: #202020;
      border-radius: 12px;
      padding: 15px;
      margin: 0 20px 20px 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .friends-bar h2 {
      font-size: 18px;
      color: #ff9800;
      margin: 0 0 15px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid #333;
    }

    .friends-list {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: flex-start;
    }

    .friend {
      display: flex;
      align-items: center;
      gap: 10px;
      background: #2a2a2a;
      padding: 8px 12px;
      border-radius: 8px;
      width: calc(33.33% - 10px);
      min-width: 200px;
      transition: all 0.3s ease;
    }

    .friend:hover {
      background: #333;
      transform: translateY(-2px);
    }

    .friend img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #ff9800;
    }

    .friend h3 {
      margin: 0;
      font-size: 14px;
      color: #f5f5f5;
      flex-grow: 1;
    }

    .friend .btn {
      padding: 5px 10px;
      font-size: 12px;
      min-width: 70px;
    }

    .no-friends {
      text-align: center;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      min-height: 150px;  /* Add minimum height to ensure vertical centering */
    }

    .no-friends-img {
      width: 60px;
      height: 60px;
      margin-bottom: 10px;
      opacity: 0.7;
    }

    .no-friends p {
      margin: 0 0 15px 0;
      color: #ccc;
      font-size: 14px;
    }

    .add-friend-btn {
      padding: 8px 16px;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .friends-bar {
        margin: 0 10px 15px 10px;
      }

      .friend {
        width: 100%;
        min-width: unset;
      }
    }

    .popular-songs {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .song-card {
      width: 100%;
      background: #202020;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .song-card:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
    }

    .song-card img {
      width: 150px;
      height: 150px;
      border-radius: 12px;
      object-fit: cover;
      border: 3px solid #ff9800;
      margin-bottom: 15px;
    }

    .song-card h3 {
      margin: 10px 0 5px 0;
      font-size: 18px;
      color: #ff9800;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .song-card p {
      margin: 0 0 15px 0;
      font-size: 14px;
      color: #ccc;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .play-button {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 8px 20px;
      font-size: 14px;
      cursor: pointer;
    }

    .loading-spinner {
      text-align: center;
      padding: 20px;
      color: #ff9800;
    }

    .error-message {
      text-align: center;
      padding: 20px;
      color: #ff5722;
    }

    .show-more-container {
      text-align: center;
      margin: 20px 0 40px 0;
    }

    .show-more-btn {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 12px 30px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .show-more-btn:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
      transform: translateY(-2px);
    }

    .show-more-btn i {
      font-size: 14px;
      transition: transform 0.3s ease;
    }

    .show-more-btn:hover i {
      transform: translateX(5px);
    }

    @media (max-width: 1024px) {
      .popular-songs {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .popular-songs {
        grid-template-columns: 1fr;
      }
    }

    .main-content h2 {
      font-size: 24px;
      margin: 30px 0 15px 20px;
      color: #fff;
    }

    .song-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 16px;
      padding: 0 20px;
      max-width: 1800px;
      margin: 0 auto;
    }

    .song-card {
      width: 100%;
      background: #181818;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease, background-color 0.2s ease;
    }

    .song-card:hover {
      transform: translateY(-4px);
      background: #282828;
    }

    .song-card img {
      width: 160px;
      height: 160px;
      border-radius: 4px;
      object-fit: cover;
      margin-bottom: 8px;
    }

    .song-card h3 {
      font-size: 14px;
      margin: 6px 0 4px;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 4px;
    }

    .song-card p {
      font-size: 12px;
      color: #b3b3b3;
      margin: 0 0 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 4px;
    }

    .play-button {
      background:  #ff5722;
      color: white;
      border: none;
      border-radius: 15px;
      padding: 4px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.2s ease;
      margin-top: 4px;
    }

    .song-card:hover .play-button {
      opacity: 1;
    }

    .play-button:hover {
      background: #ff5722;
      transform: scale(1.05);
    }

    .play-button.disabled {
      background: #404040;
      cursor: not-allowed;
    }

    .show-more-container {
      text-align: center;
      margin: 16px 0 30px;
    }

    .show-more-btn {
      background: transparent;
      color: #b3b3b3;
      border: none;
      font-size: 14px;
      cursor: pointer;
      transition: color 0.2s ease;
      padding: 8px 16px;
    }

    .show-more-btn:hover {
      color: #fff;
    }

    .show-more-btn i {
      font-size: 12px;
      margin-left: 4px;
    }

    @media (max-width: 1200px) {
      .song-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .song-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
        padding: 0 12px;
      }

      .song-card img {
        width: 140px;
        height: 140px;
      }
    }

    @media (max-width: 480px) {
      .song-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 8px;
        padding: 0 8px;
      }

      .song-card img {
        width: 120px;
        height: 120px;
      }
    }

    .radio-station {
      font-size: 12px;
      color: #ff9800;
      margin: 0 0 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 4px;
    }

    .song-card .play-button {
      background: #ff5722;
      color: white;
      border: none;
      border-radius: 15px;
      padding: 4px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.2s ease;
      margin-top: 4px;
    }

    .song-card .play-button:hover {
      transform: scale(1.05);
      background:  #ff5722;
    }

    .song-card .play-button.disabled {
      background: #404040;
      cursor: not-allowed;
    }

    .song-card .play-button.disabled:hover {
      transform: none;
      background: #404040;
    }

    /* Add these new playlist-specific styles */
    .playlists-container {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .create-playlist {
      background: #202020;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      text-align: center;
    }

    .create-playlist h2 {
      color: #ff9800;
      margin-bottom: 15px;
    }

    .playlist-form {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 15px;
    }

    .playlist-form input {
      padding: 10px;
      border-radius: 25px;
      border: 2px solid #ff9800;
      background: #181818;
      color: white;
      width: 300px;
    }

    .playlist-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .playlist-card {
      background: #202020;
      border-radius: 12px;
      padding: 15px;
      transition: transform 0.3s ease;
    }

    .playlist-card:hover {
      transform: translateY(-5px);
    }

    .playlist-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .playlist-actions {
      display: flex;
      gap: 5px;
    }

    .playlist-actions button {
      background: none;
      border: none;
      color: #ff9800;
      cursor: pointer;
      padding: 5px;
    }

    .playlist-songs {
      margin-top: 10px;
      max-height: 200px;
      overflow-y: auto;
    }

    .playlist-song {
      display: flex;
      align-items: center;
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 5px;
      background: #181818;
    }

    .playlist-song img {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      margin-right: 10px;
    }

    .song-info {
      flex-grow: 1;
    }

    .song-info h4 {
      margin: 0;
      font-size: 14px;
      color: #fff;
    }

    .song-info p {
      margin: 0;
      font-size: 12px;
      color: #b3b3b3;
    }

    .remove-song {
      background: none;
      border: none;
      color: #ff5722;
      cursor: pointer;
    }

    .empty-playlist {
      text-align: center;
      padding: 20px;
      color: #b3b3b3;
    }

    /* Add to playlist button styles */
    .add-to-playlist {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      border: none;
      border-radius: 15px;
      padding: 4px 12px;
      font-size: 12px;
      cursor: pointer;
      margin-left: 10px;
    }

    .playlist-dropdown {
      position: absolute;
      background: #202020;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      display: none;
    }

    .playlist-dropdown button {
      display: block;
      width: 100%;
      padding: 8px;
      text-align: left;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    .playlist-dropdown button:hover {
      background: #333;
    }

    /* Do Not Disturb Button Styling */
    .status-toggle-btn {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      background: none;
      border: none;
      color: #b3b3b3;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: color 0.3s ease;
    }

    .status-toggle-btn:hover {
      color: #ff9800;
    }

    .status-toggle-btn i {
      font-size: 14px;
    }

    .status-dot.status-dnd {
      background-color: #e74c3c;
    }

    /* Tooltip styling */
    .status-dot.status-dnd::after {
      content: "You are in Do Not Disturb mode";
      position: absolute;
      bottom: -30px;
      right: -80px;
      background: #333;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .status-dot.status-dnd:hover::after {
      visibility: visible;
      opacity: 1;
    }

    .language-selector {
      padding: 12px 20px;
    }

    .language-selector select {
      width: 100%;
      padding: 8px;
      background: #202020;
      color: #b3b3b3;
      border: 1px solid #404040;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .language-selector select:hover {
      border-color: #ff9800;
      color: #fff;
    }

    .language-selector select:focus {
      outline: none;
      border-color: #ff9800;
      box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);
    }

    .language-selector select option {
      background: #202020;
      color: #b3b3b3;
      padding: 8px;
    }

    /* Hide Google Translate widget */
    .goog-te-banner-frame {
      display: none !important;
    }

    body {
      top: 0 !important;
    }

    /* Adjust mobile responsiveness */
    @media (max-width: 768px) {
      .language-selector {
        padding: 12px;
      }

      .language-selector select {
        font-size: 12px;
        padding: 6px;
      }
    }

    .language-modal {
      background: #202020;
      border: none;
      border-radius: 12px;
      padding: 24px;
      max-width: 600px;
      width: 90%;
      color: #fff;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .language-modal::backdrop {
      background: rgba(0, 0, 0, 0.8);
    }

    .language-modal h2 {
      text-align: center;
      color: #ff9800;
      margin-bottom: 24px;
      font-size: 24px;
    }

    .language-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 16px;
      margin-bottom: 16px;
    }

    .language-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 16px;
      background: #2a2a2a;
      border: 2px solid transparent;
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .language-btn:hover {
      background: #333;
      border-color: #ff9800;
      transform: translateY(-2px);
    }

    .language-btn img {
      width: 40px;
      height: 30px;
      object-fit: cover;
      border-radius: 4px;
    }

    .close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      background: none;
      border: none;
      color: #ff9800;
      font-size: 20px;
      cursor: pointer;
      padding: 4px;
      transition: transform 0.3s ease;
    }

    .close-btn:hover {
      transform: rotate(90deg);
    }

    @media (max-width: 480px) {
      .language-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .language-btn {
        padding: 12px;
      }
      
      .language-btn img {
        width: 32px;
        height: 24px;
      }
    }

    /* Add these new styles */
    .dropdown-menu {
      animation: slideIn 0.3s ease-out;
      transform-origin: top right;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .profile-picture-container {
      position: relative;
      width: 120px;
      height: 120px;
      margin-bottom: 20px;
      border-radius: 50%;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .profile-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      width: 100%;
    }

    .profile-action-btn {
      flex: 1;
      padding: 8px 12px;
      border: none;
      border-radius: 20px;
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .profile-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
    }

    .profile-action-btn.secondary {
      background: #333;
    }

    .profile-themes {
      margin-top: 15px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
    }

    .theme-title {
      font-size: 14px;
      color: #b3b3b3;
      margin-bottom: 10px;
      text-align: center;
    }

    .theme-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    .theme-option {
      aspect-ratio: 1;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .theme-option:hover {
      transform: scale(1.1);
    }

    .theme-option.selected {
      border-color: #ff9800;
    }

    .profile-customization {
      margin-top: 15px;
    }

    .custom-upload-btn {
      width: 100%;
      padding: 10px;
      background: rgba(255, 152, 0, 0.1);
      border: 1px dashed #ff9800;
      border-radius: 8px;
      color: #ff9800;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .custom-upload-btn:hover {
      background: rgba(255, 152, 0, 0.2);
    }

    .profile-stats {
      display: flex;
      justify-content: space-around;
      margin-top: 15px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
    }

    .stat-item {
      text-align: center;
    }

    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #ff9800;
    }

    .stat-label {
      font-size: 12px;
      color: #b3b3b3;
    }

    /* Add these styles to your existing CSS */
    .user-profile {
      position: relative;
      cursor: pointer;
    }

    .user-initial {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      overflow: hidden;
    }

    .user-initial img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      position: absolute;
      bottom: 0;
      right: 0;
      background: #34a853;
      border: 2px solid #181818;
    }

    .status-online {
      background-color: #34a853;
    }

    .status-idle {
      background-color: #fbbc05;
      clip-path: polygon(0 0, 100% 0, 100% 50%, 0 50%);
    }

    .status-offline {
      background-color: #9aa0a6;
    }

    .profile-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: #202020;
      border-radius: 12px;
      padding: 20px;
      width: 300px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      display: none;
      z-index: 1000;
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .profile-picture-container {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      background: var(--profile-bg, linear-gradient(45deg, #ff9800, #ff5722));
    }

    .profile-info {
      flex: 1;
    }

    .profile-info span {
      display: block;
    }

    .profile-info span:first-child {
      font-size: 18px;
      font-weight: bold;
      color: #fff;
    }

    .profile-info span:last-child {
      font-size: 14px;
      color: #b3b3b3;
    }

    .profile-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .profile-actions button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .customize-btn {
      background: linear-gradient(to right, #ff9800, #ff5722);
      color: white;
    }

    .customize-btn:hover {
      background: linear-gradient(to left, #ff5722, #ff9800);
      box-shadow: 0 0 12px #ff9800;
    }

    .logout-btn {
      background: #333;
      color: #fff;
    }

    .logout-btn:hover {
      background: #444;
    }

    /* Add these styles */
    .auth-buttons {
        display: flex;
        gap: 15px;
    }

    .login-btn, .signin-btn {
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
    }

    .login-btn {
        background: transparent;
        color: #ff9800;
        border: 2px solid #ff9800;
    }

    .login-btn:hover {
        background: rgba(255, 152, 0, 0.1);
    }

    .signin-btn {
        background: linear-gradient(to right, #ff9800, #ff5722);
        color: white;
    }

    .signin-btn:hover {
        background: linear-gradient(to left, #ff5722, #ff9800);
        box-shadow: 0 0 12px #ff9800;
    }

    /* Add these new styles for the profile dropdown */
    .profile-container {
        position: relative;
    }

    .profile-dropdown {
        position: absolute;
        top: calc(100% + 10px);
        right: 0;
        background: #202020;
        border-radius: 8px;
        width: 200px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        display: none;
        z-index: 1000;
    }

    .profile-dropdown.show {
        display: block;
    }

    .dropdown-item {
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: #fff;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .dropdown-item:hover {
        background-color: #303030;
    }

    .dropdown-item i {
        color: #ff9800;
        width: 20px;
        text-align: center;
    }

    .dropdown-divider {
        height: 1px;
        background-color: #333;
        margin: 4px 0;
    }

    /* Update existing user profile styles */
    .user-profile {
        cursor: pointer;
        position: relative;
    }

    .user-initial {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        color: white;
        overflow: hidden;
    }

    .user-initial img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        position: absolute;
        bottom: 0;
        right: 0;
        background: #34a853;
        border: 2px solid #181818;
    }

    /* Keep existing auth button styles */
  </style>
</head>
<body>
  <!-- Updated navbar section -->
  <div class="navbar">
    <div class="nav-left">
        <img src="game_15459691 (1).png" alt="Meladi Logo" class="logo">
        <h1>Meladi</h1>
    </div>
    
    <div class="nav-center">
        <div class="nav-actions">
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search">
            </div>
            <button class="icon-btn search-btn" onclick="handleSearch()">
                <i class="fas fa-search"></i>
            </button>
            <button class="icon-btn browse-btn" onclick="window.location.href='browser.html'">
                <i class="fas fa-compass"></i>
            </button>
        </div>
    </div>

    <div class="nav-right" id="navRight">
        <!-- This section will be dynamically updated based on auth status -->
    </div>
</div>

<style>
/* Updated navbar styles */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background: #181818;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
}

.nav-left {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo {
    width: 40px;
    height: 40px;
}

.nav-center {
    display: flex;
    justify-content: center;
    flex: 1;
}

.nav-actions {
    display: flex;
    align-items: center;
    gap: 10px;
}

.search-container {
    background: #333;
    border-radius: 20px;
    padding: 5px 15px;
    width: 200px; /* Decreased width */
}

.search-container input {
    width: 100%;
    background: none;
    border: none;
    color: white;
    padding: 8px;
    font-size: 14px;
}

.search-container input:focus {
    outline: none;
}

/* Icon buttons style */
.icon-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    background: #333;
    color: #ff9800;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.icon-btn:hover {
    background: #444;
    transform: scale(1.1);
}

.icon-btn i {
    font-size: 16px;
}

.nav-right {
    display: flex;
    align-items: center;
}

/* Auth button styles */
.auth-buttons {
    display: flex;
    gap: 15px;
}

.login-btn, .signin-btn {
    padding: 8px 20px;
    border-radius: 25px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
}

.login-btn {
    background: transparent;
    color: #ff9800;
    border: 2px solid #ff9800;
}

.login-btn:hover {
    background: rgba(255, 152, 0, 0.1);
}

.signin-btn {
    background: linear-gradient(to right, #ff9800, #ff5722);
    color: white;
}

.signin-btn:hover {
    background: linear-gradient(to left, #ff5722, #ff9800);
    box-shadow: 0 0 12px #ff9800;
}
</style>

<script>
function handleSearch() {
    const searchTerm = document.getElementById('searchInput').value.trim();
    if (searchTerm) {
        window.location.href = `search-results.html?q=${encodeURIComponent(searchTerm)}`;
    }
}

// Add event listener for Enter key in search input
document.getElementById('searchInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        handleSearch();
    }
});
</script>

<script>
// Updated authentication check and profile management
function checkAuthStatus() {
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    const navRight = document.getElementById('navRight');

    if (currentUser) {
        // User is logged in - show profile with dropdown
        navRight.innerHTML = `
            <div class="profile-container">
                <div class="user-profile" id="userProfile">
                    <div class="user-initial" id="userInitial"></div>
                    <div class="status-dot" id="statusDot" title="Online"></div>
                </div>
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="dropdown-item" onclick="window.location.href='customize-profile.html'">
                        <i class="fas fa-paint-brush"></i>
                        Customize Profile
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-item" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        Log Out
                    </div>
                </div>
            </div>
        `;
        initializeUserProfile(currentUser);
    } else {
        // User is not logged in - show auth buttons
        navRight.innerHTML = `
            <div class="auth-buttons">
                <button onclick="window.location.href='login.html'" class="login-btn">Log In</button>
                <button onclick="window.location.href='signin.html'" class="signin-btn">Sign In</button>
            </div>
        `;
    }
}

function initializeUserProfile(user) {
    const userInitial = document.getElementById('userInitial');
    const profileContainer = document.querySelector('.profile-container');
    const profileDropdown = document.getElementById('profileDropdown');

    // Set up profile picture or initial
    if (user.profilePicture) {
        userInitial.innerHTML = `<img src="${user.profilePicture}" alt="Profile">`;
    } else {
        userInitial.style.backgroundColor = user.backgroundColor || '#ff9800';
        userInitial.textContent = user.username.charAt(0).toUpperCase();
    }

    // Toggle dropdown on profile click
    document.addEventListener('click', function(e) {
        if (profileContainer.contains(e.target)) {
            profileDropdown.classList.toggle('show');
        } else {
            profileDropdown.classList.remove('show');
        }
    });
}

function handleLogout() {
    // Update user status to offline in users list
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (currentUser) {
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.email === currentUser.email);
        if (userIndex !== -1) {
            users[userIndex].online = false;
            localStorage.setItem('users', JSON.stringify(users));
        }
    }
    
    // Clear current user
    localStorage.removeItem('currentUser');
    
    // Simply update the nav-right section without redirecting
    const navRight = document.getElementById('navRight');
    navRight.innerHTML = `
        <div class="auth-buttons">
            <button onclick="window.location.href='login.html'" class="login-btn">Log In</button>
            <button onclick="window.location.href='signin.html'" class="signin-btn">Sign In</button>
        </div>
    `;

    // Close any open dropdowns
    const dropdowns = document.querySelectorAll('.profile-dropdown');
    dropdowns.forEach(dropdown => dropdown.classList.remove('show'));
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', checkAuthStatus);
</script>

  <div class="container">
    <div class="sidebar">
      <div class="logo">
        <img src="assets/images/logo.png" alt="Meladi Logo">
        <h1>Meladi</h1>
      </div>
      <nav>
        <ul>
          <li class="nav-item active">
            <a href="meladi.html">
              <i class="fas fa-home"></i>
              <span>Home</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="browse.html">
              <i class="fas fa-compass"></i>
              <span>Browse</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="library.html">
              <i class="fas fa-book-open"></i>
              <span>Library</span>
            </a>
          </li>
          <li class="nav-divider"></li>
          <li class="nav-item">
            <a href="playlists.html">
              <i class="fas fa-list"></i>
              <span>Playlists</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="favorites.html">
              <i class="fas fa-heart"></i>
              <span>Favorites</span>
            </a>
          </li>
          <li class="nav-divider"></li>
          <li class="nav-header">Discover</li>
          <li class="nav-item">
            <a href="genre.html?type=pop">
              <i class="fas fa-music"></i>
              <span>Pop</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="genre.html?type=rock">
              <i class="fas fa-guitar"></i>
              <span>Rock</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="genre.html?type=hiphop">
              <i class="fas fa-compact-disc"></i>
              <span>Hip Hop</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="genre.html?type=jazz">
              <i class="fas fa-saxophone"></i>
              <span>Jazz</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="genre.html?type=classical">
              <i class="fas fa-violin"></i>
              <span>Classical</span>
            </a>
          </li>
          <li class="nav-divider"></li>
          <li class="nav-item">
            <a href="#" onclick="openLanguageModal(event)">
              <i class="fas fa-globe"></i>
              <span>Language</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="recent-searches.html">
              <i class="fas fa-history"></i>
              <span>Recent Searches</span>
            </a>
          </li>
          
          </li>
        </ul>
      </nav>
    </div>
    <script>
      function handleSearch() {
          const searchTerm = document.getElementById('searchInput').value.trim();
          if (searchTerm) {
              // Add to recent searches
              addSearch(
                  searchTerm,
                  'Unknown Artist', // Update with actual artist when available
                  'https://via.placeholder.com/50' // Update with actual image when available
              );
              
              // Perform search
              window.location.href = `search-results.html?q=${encodeURIComponent(searchTerm)}`;
          }
      }
      </script>
    <!-- Move search bar here, above friends bar -->
    <div class="search-container">
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search...">
        <button id="searchButton">
          <i class="fas fa-search"></id>
        </button>
        <button id="browseButton" onclick="window.location.href='browser.html'">
          <i class="fas fa-folder-open"></i>
        </button>
      </div>
    </div>

    <!-- Friends Bar Section -->
    <div class="friends-bar">
      <h2>Your Friends</h2>
      <div id="friendsList" class="friends-list">
        <div class="no-friends">
          <img src="people_14140328.png" alt="No Friends" class="no-friends-img">
          <p>How about you go add some friends, <span id="username">User</span>?</p>
          <button class="btn add-friend-btn" onclick="addFriendPage()">Add Friends</button>
        </div>
      </div>
    </div>
    <script>
      const maxFriends = 6;
    let friends = []; // Array to hold friends (initially empty)

    // Function to display friends in the bar
    function displayFriends() {
      const friendsList = document.getElementById('friendsList');
      friendsList.innerHTML = ''; // Clear existing content

      if (friends.length === 0) {
        friendsList.innerHTML = `
          <div class="no-friends">
            <img src="images/people_14140328.png" alt="No Friends" class="no-friends-img">
            <p>How about you go add some friends, <span id="username">User</span>?</p>
            <button class="btn add-friend-btn" onclick="addFriendPage()">Add Friends</button>
          </div>
        `;
        return;
      }

      friends.forEach(friend => {
        const friendElement = document.createElement('div');
        friendElement.className = 'friend';
        friendElement.innerHTML = `
          <img src="${friend.profilePicture}" alt="${friend.name}">
          <h3>${friend.name}</h3>
          <button class="btn" onclick="removeFriend('${friend.id}')">Remove</button>
        `;
        friendsList.appendChild(friendElement);
      });
    }

    // Function to add a friend (for testing purposes)
    function addFriend(name, profilePicture) {
      if (friends.length >= maxFriends) {
        alert('You can only display up to 6 friends!');
        return;
      }

      const newFriend = {
        id: Date.now().toString(), // Unique ID
        name,
        profilePicture,
      };

      friends.push(newFriend);
      displayFriends();
    }

    // Function to remove a friend
    function removeFriend(id) {
      friends = friends.filter(friend => friend.id !== id);
      displayFriends();
    }

    // Placeholder for add friend page redirection
    function addFriendPage() {
      alert('Redirecting to Add Friends page...');
    }

    // Initialize with no friends
    displayFriends();

    </script>
    <div class="main-content">
      <h2>Trending Now</h2>
      <div class="song-grid" id="trendingContainer">
        <!-- Trending songs will be populated here -->
      </div>
      <div class="show-more-container">
        <button class="show-more-btn" onclick="window.location.href='trending.html'">
          Show More <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <h2>Popular Songs</h2>
      <div class="song-grid" id="popularSongsContainer">
        <!-- Popular songs content will be populated here -->
      </div>
      <div class="show-more-container">
        <button class="show-more-btn" onclick="window.location.href='popular-songs.html'">
          Show More <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <h2>Popular Radio</h2>
      <div class="song-grid" id="radioContainer">
        <!-- Radio content will be populated here -->
      </div>
      <div class="show-more-container">
        <button class="show-more-btn" onclick="window.location.href='radio-stations.html'">
          Show More <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
    
  <dialog id="signInDialog">
  <form method="dialog">
    <h2>Sign In</h2>
    <label for="signInEmail">Email:</label>
    <input type="email" id="signInEmail" name="email" required placeholder="Enter your email">
    <label for="signInPassword">Password:</label>
    <input type="password" id="signInPassword" name="password" required placeholder="Enter your password">
    <menu>
      <button type="submit">Sign In</button>
      <button type="button" onclick="document.getElementById('signInDialog').close()">Cancel</button>
    </menu>
  </form>
</dialog>
<!-- Update the HTML to include a container for the user profile -->
<div class="user-profile" id="userProfile">
  <div class="user-initial" id="userInitial"></div>
  <div class="status-dot" id="statusDot" title=""></div>
  
  <!-- Profile Dropdown -->
  <div class="profile-dropdown" id="profileDropdown">
    <div class="profile-header">
      <div class="profile-picture-container">
        <img id="profilePicture" src="" alt="Profile">
      </div>
      <div class="profile-info">
        <span id="profileUsername"></span>
        <span id="profileEmail"></span>
      </div>
    </div>
    <div class="profile-actions">
      <button onclick="window.location.href='customize-profile.html'" class="customize-btn">
        <i class="fas fa-paint-brush"></i> Customize Profile
      </button>
      <button onclick="handleLogout()" class="logout-btn">
        <i class="fas fa-sign-out-alt"></i> Logout
      </button>
    </div>
  </div>
</div>
<dialog id="logInDialog">
  <form method="dialog">
    <h2>Log In</h2>
    <label for="logInEmail">Email:</label>
    <input type="email" id="logInEmail" name="email" required placeholder="Enter your email">
    <label for="logInPassword">Password:</label>
    <input type="password" id="logInPassword" name="password" required placeholder="Enter your password">
    <menu>
      <button type="submit">Log In</button>
      <button type="button" onclick="document.getElementById('logInDialog').close()">Cancel</button>
    </menu>
  </form>
</dialog>
<script>
  let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
  const colors = ['#4285f4', '#34a853', '#fbbc05', '#ea4335', '#ff6d01', '#46bdc6'];

  function getRandomColor() {
    return colors[Math.floor(Math.random() * colors.length)];
  }

  function updateUserProfile(user) {
    const userInitial = document.getElementById('userInitial');
    const userEmail = document.getElementById('userEmail');
    const statusDot = document.getElementById('statusDot');
    const authButtons = document.getElementById('authButtons');
    const userProfileContainer = document.getElementById('userProfileContainer');

    if (user.profileImage) {
        userInitial.innerHTML = `<img src="${user.profileImage}" alt="${user.username}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
    } else {
        userInitial.textContent = user.username.charAt(0).toUpperCase();
        userInitial.style.backgroundColor = user.backgroundColor || getRandomColor();
    }

    // Display username instead of email
    userEmail.textContent = user.username;
    statusDot.className = 'status-dot status-online';
    authButtons.style.display = 'none';
    userProfileContainer.style.display = 'flex';

    // Check and apply DND state
    const isDND = localStorage.getItem('dndMode') === 'true';
    if (isDND) {
        statusDot.className = 'status-dot status-dnd';
        document.getElementById('dndButton').innerHTML = '<i class="fas fa-moon"></i> Turn Off Do Not Disturb';
    }
}

  // Update the DOMContentLoaded event listener
  window.addEventListener('DOMContentLoaded', () => {
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (currentUser && currentUser.username) {
        updateUserProfile(currentUser);
    }
  });

  // Simplified sign in form submission
  document.querySelector('#signInDialog form').addEventListener('submit', (e) => {
    e.preventDefault();
    const email = document.getElementById('signInEmail').value;
    
    if (email) {
      updateUserProfile(email);
      document.getElementById('signInDialog').close();
    } else {
      alert('Please enter an email');
    }
  });

  // Simplified login form submission
  document.querySelector('#logInDialog form').addEventListener('submit', (e) => {
    e.preventDefault();
    const email = document.getElementById('logInEmail').value;
    
    if (email) {
      updateUserProfile(email);
      document.getElementById('logInDialog').close();
    } else {
      alert('Please enter an email');
    }
  });

  // Handle logout
  function handleLogout() {
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (currentUser) {
        // Update user status to offline in users list
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.email === currentUser.email);
        if (userIndex !== -1) {
            users[userIndex].online = false;
            localStorage.setItem('users', JSON.stringify(users));
        }
    }
    
    localStorage.removeItem('currentUser');
    window.location.href = 'login.html';
  }

  // Toggle dropdown menu
  document.getElementById('userProfileContainer').addEventListener('click', () => {
    const dropdown = document.getElementById('userDropdown');
    dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
  });

  // Close dropdown when clicking outside
  document.addEventListener('click', (e) => {
    const userProfile = document.getElementById('userProfileContainer');
    const dropdown = document.getElementById('userDropdown');
    
    if (!userProfile.contains(e.target)) {
      dropdown.style.display = 'none';
    }
  });

  // Update online/offline status
  document.addEventListener('visibilitychange', () => {
    const statusDot = document.getElementById('statusDot');
    if (currentUser) {
      if (document.hidden) {
        statusDot.className = 'status-dot status-offline';
        currentUser.online = false;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
      } else {
        statusDot.className = 'status-dot status-online';
        currentUser.online = true;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
      }
    }
  });
</script>

<!-- Add this script before the closing body tag -->
<script>
  // Cache management functions
  const CACHE_KEY = 'trending_songs_cache';
  const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

  function saveToCache(songs) {
    const cacheData = {
      timestamp: Date.now(),
      songs: songs
    };
    localStorage.setItem(CACHE_KEY, JSON.stringify(cacheData));
  }

  function getFromCache() {
    const cached = localStorage.getItem(CACHE_KEY);
    if (!cached) return null;

    const cacheData = JSON.parse(cached);
    const isExpired = Date.now() - cacheData.timestamp > CACHE_DURATION;
    
    return isExpired ? null : cacheData.songs;
  }

  async function getTrendingSongs() {
    try {
      if (navigator.onLine) {
        // Limit to 6 songs instead of 10
        const response = await fetch('https://itunes.apple.com/search?term=hot&attribute=mixTerm&entity=song&limit=6');
        const data = await response.json();
        const songs = data.results.map(track => ({
          title: track.trackName,
          artist: track.artistName,
          image: track.artworkUrl100.replace('100x100', '300x300'),
          previewUrl: track.previewUrl,
          genre: track.primaryGenreName
        }));
        
        saveToCache(songs);
        return songs;
      } else {
        const cachedSongs = getFromCache();
        if (cachedSongs) {
          console.log('Using cached songs (offline)');
          return cachedSongs;
        }
        throw new Error('No internet connection and no cached data available');
      }
    } catch (error) {
      console.error('Error fetching trending songs:', error);
      
      const cachedSongs = getFromCache();
      if (cachedSongs) {
        console.log('Using cached songs (fetch failed)');
        return cachedSongs;
      }
      
      return getFallbackSongs().slice(0, 6); // Limit fallback songs to 6
    }
  }

  // Fallback songs when both network and cache fail
  function getFallbackSongs() {
    return [
      {
        title: "Blinding Lights",
        artist: "The Weeknd",
        image: "https://via.placeholder.com/300x300?text=Blinding+Lights",
        previewUrl: null
      },
      {
        title: "Stay",
        artist: "Kid LAROI & Justin Bieber",
        image: "https://via.placeholder.com/300x300?text=Stay",
        previewUrl: null
      },
      {
        title: "Heat Waves",
        artist: "Glass Animals",
        image: "https://via.placeholder.com/300x300?text=Heat+Waves",
        previewUrl: null
      },
      {
        title: "As It Was",
        artist: "Harry Styles",
        image: "https://via.placeholder.com/300x300?text=As+It+Was",
        previewUrl: null
      }
    ];
  }

  async function populateTrendingSongs() {
    const trendingContainer = document.getElementById('trendingContainer');
    trendingContainer.innerHTML = '<div class="loading">Loading trending songs...</div>';

    try {
      const songs = await getTrendingSongs();
      trendingContainer.innerHTML = '';

      if (songs.length === 0) {
        trendingContainer.innerHTML = '<div class="error">No songs available</div>';
        return;
      }

      // Add network status indicator
      const statusBar = document.createElement('div');
      statusBar.className = `status-bar ${navigator.onLine ? 'online' : 'offline'}`;
      statusBar.textContent = navigator.onLine ? 'Online Mode' : 'Offline Mode';
      trendingContainer.appendChild(statusBar);

      songs.forEach(song => {
        const songElement = document.createElement('div');
        songElement.className = 'trending-item';
        songElement.innerHTML = `
          <img src="${song.image}" alt="${song.title}" onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
          <h3>${song.title}</h3>
          <p>${song.artist}</p>
          <div class="button-container">
            ${song.previewUrl && navigator.onLine ? `
              <button onclick="playSong('${song.previewUrl}')" class="action-button">
                <span class="play-text">Play</span>
              </button>
            ` : `
              <button class="action-button disabled">
                <span>${navigator.onLine ? 'Preview Unavailable' : 'Offline Mode'}</span>
              </button>
            `}
          </div>
        `;
        trendingContainer.appendChild(songElement);
      });
    } catch (error) {
      console.error('Error:', error);
      trendingContainer.innerHTML = '<div class="error">Error loading trending songs</div>';
    }
  }

  // Add network status styles
  const networkStyles = document.createElement('style');
  networkStyles.textContent = `
    .status-bar {
      width: 100%;
      padding: 10px;
      text-align: center;
      margin-bottom: 20px;
      border-radius: 8px;
      font-weight: bold;
    }

    .status-bar.online {
      background: #34a853;
      color: white;
    }

    .status-bar.offline {
      background: #ea4335;
      color: white;
    }

    .action-button.disabled {
      opacity: 0.6;
      cursor: not-allowed;
      background: #666;
    }

    .action-button.disabled:hover {
      transform: none;
      background: #666;
    }
  `;
  document.head.appendChild(networkStyles);

  // Listen for online/offline events
  window.addEventListener('online', () => {
    console.log('Back online, refreshing songs...');
    populateTrendingSongs();
  });

  window.addEventListener('offline', () => {
    console.log('Gone offline, using cached data...');
    populateTrendingSongs();
  });

  // Rest of your existing code (playSong function, etc.) remains the same...
</script>

<script>
  async function fetchPopularSongs() {
    const container = document.getElementById('popularSongsContainer');
    container.innerHTML = '<div class="loading-spinner">Loading popular songs...</div>';

    try {
      const cachedSongs = getFromCache('popular_songs');
      if (cachedSongs) {
        displaySongs(cachedSongs.slice(0, 6)); // Limit to 6 songs
        return;
      }

      const response = await fetch('https://itunes.apple.com/search?term=popular&entity=song&limit=6');
      if (!response.ok) throw new Error('Failed to fetch songs');
      
      const data = await response.json();
      const songs = data.results.map(track => ({
        id: track.trackId,
        title: track.trackName,
        artist: track.artistName,
        image: track.artworkUrl100.replace('100x100', '300x300'),
        preview: track.previewUrl
      }));

      saveToCache('popular_songs', songs);
      displaySongs(songs);

    } catch (error) {
      console.error('Error fetching popular songs:', error);
      container.innerHTML = `
        <div class="error-message">
          <p>Unable to load popular songs. Please try again later.</p>
          <button class="play-button" onclick="fetchPopularSongs()">
            <i class="fas fa-sync"></i> Retry
          </button>
        </div>
      `;
    }
  }

  function displaySongs(songs) {
    const container = document.getElementById('popularSongsContainer');
    container.innerHTML = songs.map(song => `
      <div class="song-card">
        <img src="${song.image}" alt="${song.title}" onerror="this.src='https://via.placeholder.com/150?text=No+Image'">
        <h3 title="${song.title}">${song.title}</h3>
        <p title="${song.artist}">${song.artist}</p>
        ${song.preview ? `
          <button class="play-button" onclick="playSongPreview('${song.preview}', this)">
            <i class="fas fa-play"></i> Play Preview
          </button>
        ` : `
          <button class="play-button" disabled>
            <i class="fas fa-ban"></i> No Preview
          </button>
        `}
      </div>
    `).join('');
  }

  // Cache management
  function saveToCache(key, data) {
    const cacheData = {
      timestamp: Date.now(),
      data: data
    };
    localStorage.setItem(key, JSON.stringify(cacheData));
  }

  function getFromCache(key, expirationTime = 3600000) { // 1 hour default
    const cached = localStorage.getItem(key);
    if (!cached) return null;

    const cacheData = JSON.parse(cached);
    if (Date.now() - cacheData.timestamp > expirationTime) {
      localStorage.removeItem(key);
      return null;
    }

    return cacheData.data;
  }

  // Audio player management
  let currentAudio = null;
  let currentPlayButton = null;

  function playSongPreview(previewUrl, buttonElement) {
    if (currentAudio && currentAudio.src === previewUrl) {
      // Same song - toggle play/pause
      if (currentAudio.paused) {
        currentAudio.play();
        buttonElement.innerHTML = '<i class="fas fa-pause"></i> Pause';
      } else {
        currentAudio.pause();
        buttonElement.innerHTML = '<i class="fas fa-play"></i> Play Preview';
      }
      return;
    }

    // Different song or no current audio
    if (currentAudio) {
      currentAudio.pause();
      if (currentPlayButton) {
        currentPlayButton.innerHTML = '<i class="fas fa-play"></i> Play Preview';
      }
    }

    currentAudio = new Audio(previewUrl);
    currentPlayButton = buttonElement;

    currentAudio.play();
    buttonElement.innerHTML = '<i class="fas fa-pause"></i> Pause';

    currentAudio.onended = () => {
      buttonElement.innerHTML = '<i class="fas fa-play"></i> Play Preview';
    };
  }

  // Initialize popular songs on page load
  document.addEventListener('DOMContentLoaded', () => {
    fetchPopularSongs();
  });
</script>

<script>
  // Add a search function using iTunes API
  async function searchSongs(query) {
    if (!query.trim()) return [];
    
    try {
      const response = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&entity=song&limit=10`);
      const data = await response.json();
      
      return data.results.map(track => ({
        id: track.trackId,
        title: track.trackName,
        artist: track.artistName,
        image: track.artworkUrl100.replace('100x100', '300x300'),
        preview: track.previewUrl
      }));
    } catch (error) {
      console.error('Error searching songs:', error);
      return [];
    }
  }

  // Add event listener for search
  document.getElementById('searchButton').addEventListener('click', async () => {
    const query = document.getElementById('searchInput').value;
    if (query.trim()) {
      // Store the search query in localStorage to use it in the results page
      localStorage.setItem('lastSearchQuery', query);
      // Redirect to search results page
      window.location.href = 'search-results.html';
    }
  });

  // Also add enter key support for the search input
  document.getElementById('searchInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      const query = e.target.value;
      if (query.trim()) {
        localStorage.setItem('lastSearchQuery', query);
        window.location.href = 'search-results.html';
      }
    }
  });
</script>

<script>
  // Function to fetch trending songs using iTunes chart feed
  async function getTrendingSongs() {
    try {
      if (navigator.onLine) {
        // Using iTunes API with chart parameter for actual trending songs
        const response = await fetch('https://itunes.apple.com/search?term=hot&attribute=mixTerm&entity=song&limit=10');
        const data = await response.json();
        const songs = data.results.map(track => ({
          title: track.trackName,
          artist: track.artistName,
          image: track.artworkUrl100.replace('100x100', '300x300'),
          previewUrl: track.previewUrl,
          genre: track.primaryGenreName
        }));
        
        saveToCache('trending_songs', songs);
        return songs;
      } else {
        const cachedSongs = getFromCache('trending_songs');
        if (cachedSongs) {
          console.log('Using cached trending songs (offline)');
          return cachedSongs;
        }
        throw new Error('No internet connection and no cached data available');
      }
    } catch (error) {
      console.error('Error fetching trending songs:', error);
      return getFallbackSongs().slice(0, 6); // Limit fallback songs to 6
    }
  }

  // New function to fetch popular radio stations/songs
  async function getPopularRadio() {
    try {
      if (navigator.onLine) {
        // Using a mix of popular radio stations' genres
        const genres = ['classical', 'jazz', 'rock', 'pop', 'electronic', 'country'];
        const randomGenre = genres[Math.floor(Math.random() * genres.length)];
        
        const response = await fetch(`https://itunes.apple.com/search?term=${randomGenre}&entity=song&attribute=genreTerm&limit=6`);
        const data = await response.json();
        const radioSongs = data.results.map(track => ({
          title: track.trackName,
          artist: track.artistName,
          image: track.artworkUrl100.replace('100x100', '300x300'),
          previewUrl: track.previewUrl,
          genre: track.primaryGenreName,
          radioStation: `${track.primaryGenreName} Radio`
        }));

        saveToCache('radio_songs', radioSongs);
        return radioSongs;
      } else {
        const cachedRadio = getFromCache('radio_songs');
        if (cachedRadio) {
          console.log('Using cached radio songs (offline)');
          return cachedRadio;
        }
        throw new Error('No internet connection and no cached data available');
      }
    } catch (error) {
      console.error('Error fetching radio songs:', error);
      return [];
    }
  }

  // Function to display radio content
  function displayRadioContent(songs) {
    const container = document.getElementById('radioContainer');
    if (!songs.length) {
      container.innerHTML = '<div class="error-message">Unable to load radio content</div>';
      return;
    }

    container.innerHTML = songs.map(song => `
      <div class="song-card">
        <img src="${song.image}" alt="${song.title}" onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
        <h3 title="${song.title}">${song.title}</h3>
        <p title="${song.artist}">${song.artist}</p>
        <p class="radio-station">${song.radioStation}</p>
        ${song.previewUrl ? `
          <button class="play-button" onclick="playSongPreview('${song.previewUrl}', this)">
            <i class="fas fa-play"></i> Play Preview
          </button>
        ` : `
          <button class="play-button disabled">
            <i class="fas fa-ban"></i> No Preview
          </button>
        `}
      </div>
    `).join('');
  }

  // Initialize both trending and radio sections
  async function initializeContent() {
    // Fetch and display trending songs
    const trendingSongs = await getTrendingSongs();
    const trendingContainer = document.getElementById('trendingContainer');
    trendingContainer.innerHTML = trendingSongs.map(song => `
      <div class="song-card">
        <img src="${song.image}" alt="${song.title}">
        <h3>${song.title}</h3>
        <p>${song.artist}</p>
        <p class="genre">${song.genre}</p>
        ${song.previewUrl ? `
          <button class="action-button" onclick="playSongPreview('${song.previewUrl}', this)">
            <i class="fas fa-play"></i> Play
          </button>
        ` : `
          <button class="action-button disabled">
            <i class="fas fa-ban"></i> No Preview
          </button>
        `}
      </div>
    `).join('');

    // Fetch and display radio content
    const radioSongs = await getPopularRadio();
    displayRadioContent(radioSongs);
  }

  // Add some additional styles for the radio section
  const styles = document.createElement('style');
  styles.textContent = `
    .radio-station {
      font-size: 12px;
      color: #ff9800;
      margin: 0 0 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 4px;
    }

    .song-card .play-button {
      background: #1db954;
      color: white;
      border: none;
      border-radius: 15px;
      padding: 4px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.2s ease;
      margin-top: 4px;
    }

    .song-card .play-button:hover {
      transform: scale(1.05);
      background: #1ed760;
    }

    .song-card .play-button.disabled {
      background: #404040;
      cursor: not-allowed;
    }

    .song-card .play-button.disabled:hover {
      transform: none;
      background: #404040;
    }
  `;
  document.head.appendChild(styles);

  // Initialize content when page loads
  document.addEventListener('DOMContentLoaded', initializeContent);
</script>

<script>
  function showPlaylistDropdown(event, songId, title, artist, image) {
    event.stopPropagation();
    const dropdown = document.getElementById('playlistDropdown');
    const playlists = JSON.parse(localStorage.getItem('playlists') || '[]');
    
    dropdown.style.top = `${event.clientY}px`;
    dropdown.style.left = `${event.clientX}px`;
    
    dropdown.innerHTML = playlists.length ? playlists.map(playlist => `
      <button onclick="addToPlaylist(${playlist.id}, '${songId}', '${title}', '${artist}', '${image}')">
        ${playlist.name}
      </button>
    `).join('') : '<p>No playlists available</p>';
    
    dropdown.style.display = 'block';
  }

  function addToPlaylist(playlistId, songId, title, artist, image) {
    const playlists = JSON.parse(localStorage.getItem('playlists'));
    const playlist = playlists.find(p => p.id === playlistId);
    
    if (!playlist.songs.some(s => s.id === songId)) {
      playlist.songs.push({ id: songId, title, artist, image });
      localStorage.setItem('playlists', JSON.stringify(playlists));
      alert('Song added to playlist!');
    } else {
      alert('Song already in playlist!');
    }
    
    document.getElementById('playlistDropdown').style.display = 'none';
  }

  // Close dropdown when clicking outside
  document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('playlistDropdown');
    if (!event.target.closest('.add-to-playlist')) {
      dropdown.style.display = 'none';
    }
  });
</script>

<!-- Add this script -->
<script>
// ... existing script ...

// Add DND functionality
document.addEventListener('DOMContentLoaded', () => {
  const dndButton = document.getElementById('dndButton');
  const statusDot = document.getElementById('statusDot');
  
  // Load DND state from localStorage
  const isDND = localStorage.getItem('dndMode') === 'true';
  if (isDND) {
    statusDot.className = 'status-dot status-dnd';
    dndButton.innerHTML = '<i class="fas fa-moon"></i> Turn Off Do Not Disturb';
  }

  dndButton.addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent dropdown from closing
    
    const isDNDMode = statusDot.classList.contains('status-dnd');
    
    if (isDNDMode) {
      // Switch back to online
      statusDot.className = 'status-dot status-online';
      dndButton.innerHTML = '<i class="fas fa-moon"></i> Do Not Disturb';
      localStorage.setItem('dndMode', 'false');
    } else {
      // Switch to DND
      statusDot.className = 'status-dot status-dnd';
      dndButton.innerHTML = '<i class="fas fa-moon"></i> Turn Off Do Not Disturb';
      localStorage.setItem('dndMode', 'true');
    }
  });
});
</script>

<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'en',
      includedLanguages: 'en,es,fr,de,it,ja,ko,zh,ar,hi',
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
      autoDisplay: false
    }, 'google_translate_element');
  }
</script>

<!-- Add Google Translate API -->
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- Add this hidden element for Google Translate -->
<div id="google_translate_element" style="display: none;"></div>

<!-- Update the setLanguage function in your existing script -->
<script>
function setLanguage(langCode) {
    // Save the selected language
    localStorage.setItem('preferredLanguage', langCode);
    
    // Add a loading overlay
    const overlay = document.createElement('div');
    overlay.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    `;
    
    const spinner = document.createElement('div');
    spinner.innerHTML = '<i class="fas fa-spinner fa-spin" style="color: #ff9800; font-size: 48px;"></i>';
    overlay.appendChild(spinner);
    document.body.appendChild(overlay);

    // Close the modal
    closeLanguageModal();

    // Use Google Translate API to change the language
    const select = document.querySelector('.goog-te-combo');
    if (select) {
        select.value = langCode;
        select.dispatchEvent(new Event('change'));
    }

    // Reload the page after a short delay to ensure translation is complete
    setTimeout(() => {
        window.location.reload();
    }, 1000);
}

// Add these styles to hide Google Translate elements
const styleSheet = document.createElement('style');
styleSheet.textContent = `
    .goog-te-banner-frame {
        display: none !important;
    }
    .goog-te-menu-value {
        display: none !important;
    }
    body {
        top: 0 !important;
    }
    .goog-te-gadget {
        height: 0;
    }
`;
document.head.appendChild(styleSheet);

// Load saved language preference on page load
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const langParam = urlParams.get('lang');
    const savedLang = localStorage.getItem('preferredLanguage');
    
    if (langParam && langParam !== savedLang) {
        localStorage.setItem('preferredLanguage', langParam);
    }

    // Apply saved language after a short delay to ensure Google Translate is loaded
    if (savedLang) {
        setTimeout(() => {
            const select = document.querySelector('.goog-te-combo');
            if (select) {
                select.value = savedLang;
                select.dispatchEvent(new Event('change'));
            }
        }, 1000);
    }
});
</script>

<!-- Add this language modal HTML before the closing body tag -->
<dialog id="languageModal" class="language-modal">
  <h2>Select Language</h2>
  <div class="language-grid">
    <button onclick="setLanguage('en')" class="language-btn">
      <img src="https://flagcdn.com/w40/us.png" alt="English">
      <span>English</span>
    </button>
    <button onclick="setLanguage('es')" class="language-btn">
      <img src="https://flagcdn.com/w40/es.png" alt="Español">
      <span>Español</span>
    </button>
    <button onclick="setLanguage('fr')" class="language-btn">
      <img src="https://flagcdn.com/w40/fr.png" alt="Français">
      <span>Français</span>
    </button>
    <button onclick="setLanguage('de')" class="language-btn">
      <img src="https://flagcdn.com/w40/de.png" alt="Deutsch">
      <span>Deutsch</span>
    </button>
    <button onclick="setLanguage('it')" class="language-btn">
      <img src="https://flagcdn.com/w40/it.png" alt="Italiano">
      <span>Italiano</span>
    </button>
    <button onclick="setLanguage('ja')" class="language-btn">
      <img src="https://flagcdn.com/w40/jp.png" alt="日本語">
      <span>日本語</span>
    </button>
    <button onclick="setLanguage('ko')" class="language-btn">
      <img src="https://flagcdn.com/w40/kr.png" alt="한국어">
      <span>한국어</span>
    </button>
    <button onclick="setLanguage('zh')" class="language-btn">
      <img src="https://flagcdn.com/w40/cn.png" alt="中文">
      <span>中文</span>
    </button>
    <button onclick="setLanguage('ar')" class="language-btn">
      <img src="https://flagcdn.com/w40/sa.png" alt="العربية">
      <span>العربية</span>
    </button>
    <button onclick="setLanguage('hi')" class="language-btn">
      <img src="https://flagcdn.com/w40/in.png" alt="हिन्दी">
      <span>हिन्दी</span>
    </button>
  </div>
  <button onclick="closeLanguageModal()" class="close-btn">
    <i class="fas fa-times"></i>
  </button>
</dialog>

<!-- Add this JavaScript before the closing body tag -->
<script>
  function openLanguageModal(event) {
    event.preventDefault();
    const modal = document.getElementById('languageModal');
    modal.showModal();
  }

  function closeLanguageModal() {
    const modal = document.getElementById('languageModal');
    modal.close();
  }

  function setLanguage(langCode) {
    // Save the selected language
    localStorage.setItem('preferredLanguage', langCode);
    
    // Add a loading overlay
    const overlay = document.createElement('div');
    overlay.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    `;
    
    const spinner = document.createElement('div');
    spinner.innerHTML = '<i class="fas fa-spinner fa-spin" style="color: #ff9800; font-size: 48px;"></i>';
    overlay.appendChild(spinner);
    document.body.appendChild(overlay);

    // Close the modal
    closeLanguageModal();

    // Use Google Translate API to change the language
    const select = document.querySelector('.goog-te-combo');
    if (select) {
        select.value = langCode;
        select.dispatchEvent(new Event('change'));
    }

    // Reload the page after a short delay to ensure translation is complete
    setTimeout(() => {
        window.location.reload();
    }, 1000);
  }

  // Load saved language preference on page load
  document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const langParam = urlParams.get('lang');
    const savedLang = localStorage.getItem('preferredLanguage');
    
    if (langParam && langParam !== savedLang) {
      localStorage.setItem('preferredLanguage', langParam);
    }
  });
</script>

<script>
// Profile picture and background functionality
document.addEventListener('DOMContentLoaded', () => {
  const userProfileContainer = document.getElementById('userProfileContainer');
  const userDropdown = document.getElementById('userDropdown');
  const userInfo = userDropdown.querySelector('.user-info');

  // Load user data from localStorage
  const userData = JSON.parse(localStorage.getItem('userData')) || {
    theme: 'default',
    stats: {
      playlists: 0,
      followers: 0,
      following: 0
    },
    customizations: {
      backgroundColor: '#ff9800',
      profilePicture: null,
      frameStyle: 'classic'
    }
  };

  // Update the user info HTML structure with enhanced features
  userInfo.innerHTML = `
    <div class="profile-picture-container" style="background: ${userData.customizations.backgroundColor}">
      <img src="${userData.customizations.profilePicture || 'assets/images/default-avatar.png'}" 
           alt="Profile Picture" 
           class="profile-picture"
           id="profilePicture">
      <div class="profile-upload-overlay" onclick="document.getElementById('profileFileInput').click()">
        <i class="fas fa-camera"></i>
        <span>Change Picture</span>
      </div>
    </div>
    <input type="file" id="profileFileInput" class="file-input" accept="image/*,video/*">
    <span id="userName" class="user-name">${currentUser?.username || 'User'}</span>
    <span class="user-email">${currentUser?.email || 'user@example.com'}</span>
    
    <div class="profile-stats">
      <div class="stat-item">
        <div class="stat-value">${userData.stats.playlists}</div>
        <div class="stat-label">Playlists</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">${userData.stats.followers}</div>
        <div class="stat-label">Followers</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">${userData.stats.following}</div>
        <div class="stat-label">Following</div>
      </div>
    </div>

    <div class="profile-themes">
      <div class="theme-title">Profile Themes</div>
      <div class="theme-grid">
        <div class="theme-option" style="background: linear-gradient(45deg, #ff9800, #ff5722)" data-theme="sunset"></div>
        <div class="theme-option" style="background: linear-gradient(45deg, #4285f4, #34a853)" data-theme="ocean"></div>
        <div class="theme-option" style="background: linear-gradient(45deg, #ea4335, #fbbc05)" data-theme="fire"></div>
        <div class="theme-option" style="background: linear-gradient(45deg, #7c4dff, #448aff)" data-theme="twilight"></div>
        <div class="theme-option" style="background: linear-gradient(45deg, #11998e, #38ef7d)" data-theme="forest"></div>
        <div class="theme-option" style="background: linear-gradient(45deg, #834d9b, #d04ed6)" data-theme="mystic"></div>
      </div>
    </div>

    <div class="profile-customization">
      <label class="custom-upload-btn" for="profileFileInput">
        <i class="fas fa-cloud-upload-alt"></i>
        Upload Custom Background
      </label>
    </div>

    <div class="profile-actions">
      <button class="profile-action-btn" onclick="editProfile()">
        <i class="fas fa-edit"></i>
        Edit Profile
      </button>
      <button class="profile-action-btn secondary" onclick="shareProfile()">
        <i class="fas fa-share-alt"></i>
        Share
      </button>
    </div>
  `;

  // Handle profile picture/video upload with preview
  const fileInput = document.getElementById('profileFileInput');
  fileInput.addEventListener('change', handleFileUpload);

  // Handle theme selection
  const themeOptions = document.querySelectorAll('.theme-option');
  themeOptions.forEach(option => {
    if (option.dataset.theme === userData.theme) {
      option.classList.add('selected');
    }
    option.addEventListener('click', () => handleThemeChange(option));
  });

  // Initialize tooltips
  initializeTooltips();
});

// File upload handler with preview
function handleFileUpload(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (e) => {
    const profilePicture = document.getElementById('profilePicture');
    const userInitial = document.getElementById('userInitial');
    const userData = JSON.parse(localStorage.getItem('userData')) || {};

    userData.customizations.profilePicture = e.target.result;
    localStorage.setItem('userData', JSON.stringify(userData));

    updateProfilePicture(e.target.result, file.type);
  };
  reader.readAsDataURL(file);
}

// Theme change handler
function handleThemeChange(selectedOption) {
  const userData = JSON.parse(localStorage.getItem('userData')) || {};
  const theme = selectedOption.dataset.theme;
  
  document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
  selectedOption.classList.add('selected');
  
  userData.theme = theme;
  localStorage.setItem('userData', JSON.stringify(userData));
  
  applyTheme(theme);
}

// Apply theme to profile
function applyTheme(theme) {
  const profileContainer = document.querySelector('.profile-picture-container');
  const themeStyles = {
    sunset: 'linear-gradient(45deg, #ff9800, #ff5722)',
    ocean: 'linear-gradient(45deg, #4285f4, #34a853)',
    fire: 'linear-gradient(45deg, #ea4335, #fbbc05)',
    twilight: 'linear-gradient(45deg, #7c4dff, #448aff)',
    forest: 'linear-gradient(45deg, #11998e, #38ef7d)',
    mystic: 'linear-gradient(45deg, #834d9b, #d04ed6)'
  };
  
  profileContainer.style.background = themeStyles[theme];
}

// Profile picture update
function updateProfilePicture(src, fileType) {
  const profilePicture = document.getElementById('profilePicture');
  const userInitial = document.getElementById('userInitial');

  if (fileType.startsWith('video/')) {
    userInitial.innerHTML = `
      <video autoplay loop muted playsinline style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
        <source src="${src}" type="${fileType}">
      </video>
    `;
  } else {
    profilePicture.src = src;
    userInitial.innerHTML = `<img src="${src}" alt="Profile" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
  }
}

// Initialize tooltips
function initializeTooltips() {
  const tooltips = document.querySelectorAll('[data-tooltip]');
  tooltips.forEach(element => {
    element.addEventListener('mouseenter', e => {
      const tooltip = document.createElement('div');
      tooltip.className = 'tooltip';
      tooltip.textContent = e.target.dataset.tooltip;
      document.body.appendChild(tooltip);
      
      const rect = e.target.getBoundingClientRect();
      tooltip.style.top = `${rect.top - tooltip.offsetHeight - 5}px`;
      tooltip.style.left = `${rect.left + (rect.width - tooltip.offsetWidth) / 2}px`;
    });

    element.addEventListener('mouseleave', () => {
      document.querySelector('.tooltip')?.remove();
    });
  });
}

// Edit profile function
function editProfile() {
  // Implement edit profile functionality
  console.log('Edit profile clicked');
}

// Share profile function
function shareProfile() {
  // Implement share profile functionality
  if (navigator.share) {
    navigator.share({
      title: 'Check out my Meladi profile',
      text: 'Listen to my favorite music on Meladi!',
      url: window.location.href
    }).catch(console.error);
  } else {
    // Fallback for browsers that don't support Web Share API
    const dummy = document.createElement('input');
    document.body.appendChild(dummy);
    dummy.value = window.location.href;
    dummy.select();
    document.execCommand('copy');
    document.body.removeChild(dummy);
    
    alert('Profile link copied to clipboard!');
  }
}
</script>
</body>

</html>